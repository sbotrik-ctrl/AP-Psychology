<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AP Psych Matching ‚Äì Fall Final Review</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #e5edff;
  --bg-dark: #020617;
  --card: #ffffff;
  --card-dark: #0b1220;
  --text: #0f172a;
  --text-light: #ffffff;
  --text-muted: #6b7280;
  --text-dark: #e5e7eb;

  --primary: #2563eb;
  --border: #d1d5db;

  --correct: #bbf7d0;
  --correct-text: #14532d;

  /* Category tile colors */
  --purple-bg: rgba(168,85,247,0.20);
  --purple-border: rgba(168,85,247,0.55);

  --green-bg: rgba(34,197,94,0.20);
  --green-border: rgba(34,197,94,0.55);

  --blue-bg: rgba(59,130,246,0.20);
  --blue-border: rgba(59,130,246,0.55);

  --orange-bg: rgba(249,115,22,0.22);
  --orange-border: rgba(249,115,22,0.60);

  --pink-bg: rgba(236,72,153,0.22);
  --pink-border: rgba(236,72,153,0.60);
}

* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top, #dbeafe 0, #f9fafb 40%, #e5e7eb 100%);
  color: var(--text);
}

body.dark {
  background: #020617 !important;
  color: var(--text-dark) !important;
}

.page {
  max-width: 960px;
  margin: 0 auto;
  padding: 16px 16px 40px;
}

h1 {
  text-align: center;
  margin: 12px 0 4px;
  font-size: 1.9rem;
}

h3.subtitle {
  text-align: center;
  margin: 0;
  color: var(--text-muted);
  font-size: 0.95rem;
}

/* TOP BAR FIX FOR DARK MODE */
#top-bar {
  margin-top: 14px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: center;
  align-items: center;
  font-size: 0.85rem;
}

.toggle-group {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.92);
  color: var(--text);
}

body.dark .toggle-group {
  background: #1e293b;
  border-color: #475569;
  color: var(--text-dark);
}

/* CARDS */
#menu-card, #game-card {
  background: #ffffff;
  border-radius: 18px;
  box-shadow: 0 12px 32px rgba(15,23,42,0.15);
  margin-top: 16px;
  padding: 18px 16px 20px;
}

body.dark #menu-card,
body.dark #game-card {
  background: #0f172a;
  box-shadow: 0 18px 40px rgba(15,23,42,0.85);
}

/* MENU GRID */
#menu-grid {
  margin-top: 8px;
  display: grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap: 14px;
}

/* CATEGORY TILES */
.tile {
  padding: 14px 12px;
  border-radius: 14px;
  border: 1px solid var(--border);
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(15,23,42,0.12);
  transition: transform 0.12s ease, box-shadow 0.12s ease;
}

.tile.dev { background: var(--purple-bg); border-color: var(--purple-border); }
.tile.bio { background: var(--green-bg); border-color: var(--green-border); }
.tile.cog { background: var(--blue-bg); border-color: var(--blue-border); }
.tile.sens { background: var(--orange-bg); border-color: var(--orange-border); }
.tile.stats { background: var(--pink-bg); border-color: var(--pink-border); }

.tile-header { display: flex; gap: 8px; align-items: center; }

.tile-icon {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(255,255,255,0.75);
  font-size: 1.1rem;
}

.tile:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(15,23,42,0.35);
}

/* GAME CARD HEADER */
#game-header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* RESTORED LARGE BUTTON */
.button {
  border: none;
  border-radius: 999px;
  padding: 10px 18px;
  font-size: 0.95rem;
  cursor: pointer;
  background: #1d4ed8;
  color: white;
  box-shadow: 0 4px 12px rgba(37,99,235,0.5);
}

.button.secondary {
  background: #475569;
  color: white;
}

body.dark .button.secondary {
  background: #334155;
  color: white;
}

/* STATUS BAR */
#status-bar {
  margin-top: 8px;
  padding: 6px 12px;
  display: flex;
  justify-content: space-between;
  border-radius: 999px;
  border: 1px solid #dbeafe;
  background: #eff6ff;
}

body.dark #status-bar {
  background: #1e293b;
  border-color: #3b82f6;
}

/* GAME COLUMNS */
.container {
  margin-top: 14px;
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.column {
  flex: 1 1 260px;
  background: #f9fafb;
  border-radius: 12px;
  padding: 10px;
  border: 1px solid var(--border);
  max-height: 60vh;
  overflow-y: auto;
}

body.dark .column {
  background: #1e293b;
  border-color: #334155;
}

/* ITEMS */
.item {
  padding: 7px 9px;
  margin: 3px 0;
  border-radius: 9px;
  background: white;
  border: 1px solid #d1d5db;
  cursor: pointer;
}

body.dark .item {
  background: #0f172a;
  border-color: #475569;
  color: var(--text-dark);
}

.item:hover {
  background: #e0ecff;
}

body.dark .item:hover {
  background: #334155;
}

.item.selected {
  outline: 2px solid var(--primary);
}

.item.matched {
  background: var(--correct);
  border-color: #16a34a;
  color: var(--correct-text);
}

#teachBlock {
  background: rgba(0,0,0,0.05);
  padding: 10px;
  border-radius: 10px;
}

body.dark #teachBlock {
  background: rgba(255,255,255,0.08);
}
</style>
</head>
<body>

<div class="page">
<h1>AP Psych Matching Review</h1>
<h3 class="subtitle">Tap a set, then match terms to definitions.</h3>

<!-- TOP BAR -->
<div id="top-bar">
  <label class="toggle-group">
    <input type="checkbox" id="darkToggle"> Dark Mode
  </label>
  <label class="toggle-group">
    <input type="checkbox" id="timerToggle"> Timer
  </label>
  <label class="toggle-group">
    <input type="checkbox" id="teachToggle"> Teach Mode
  </label>
</div>

<!-- MENU CARD -->
<div id="menu-card">
  <p style="margin:6px 2px 10px; font-size:0.9rem; color:var(--text-muted);">
    Choose a topic set (8‚Äì10 pairs per group).  
    <strong>Hint:</strong> Press <kbd>Shift</kbd> + <kbd>T</kbd> for teacher tools.
  </p>

  <div id="menu-grid">

    <!-- DEVELOPMENT -->
    <div class="tile dev" data-group="1">
      <div class="tile-header">
        <div class="tile-icon">üß∏</div>
        <div>
          <div class="tile-title">Group 1: Attachment</div>
          <div class="tile-subtitle">Ainsworth, parenting styles</div>
        </div>
      </div>
    </div>

    <div class="tile dev" data-group="2">
      <div class="tile-header">
        <div class="tile-icon">üå±</div>
        <div>
          <div class="tile-title">Group 2: Erikson</div>
          <div class="tile-subtitle">Psychosocial stages</div>
        </div>
      </div>
    </div>

    <div class="tile dev" data-group="3">
      <div class="tile-header">
        <div class="tile-icon">üéì</div>
        <div>
          <div class="tile-title">Group 3: Identity</div>
          <div class="tile-subtitle">Marcia‚Äôs Identity Theory</div>
        </div>
      </div>
    </div>

    <!-- BIOLOGY -->
    <div class="tile bio" data-group="4">
      <div class="tile-header">
        <div class="tile-icon">üíä</div>
        <div>
          <div class="tile-title">Group 4: Neurotransmitters</div>
          <div class="tile-subtitle">Effects & imbalances</div>
        </div>
      </div>
    </div>

    <div class="tile bio" data-group="5">
      <div class="tile-header">
        <div class="tile-icon">üîã</div>
        <div>
          <div class="tile-title">Group 5: Nervous System</div>
          <div class="tile-subtitle">Divisions & functions</div>
        </div>
      </div>
    </div>

    <div class="tile bio" data-group="6">
      <div class="tile-header">
        <div class="tile-icon">üß†</div>
        <div>
          <div class="tile-title">Group 6: Brain Structures</div>
          <div class="tile-subtitle">Regions & functions</div>
        </div>
      </div>
    </div>

    <div class="tile bio" data-group="7">
      <div class="tile-header">
        <div class="tile-icon">‚ö°</div>
        <div>
          <div class="tile-title">Group 7: Neurons</div>
          <div class="tile-subtitle">Parts & firing</div>
        </div>
      </div>
    </div>

    <div class="tile bio" data-group="8">
      <div class="tile-header">
        <div class="tile-icon">üí§</div>
        <div>
          <div class="tile-title">Group 8: Sleep & Drugs</div>
          <div class="tile-subtitle">Consciousness</div>
        </div>
      </div>
    </div>

    <!-- COGNITION -->
    <div class="tile cog" data-group="9">
      <div class="tile-header">
        <div class="tile-icon">üí≠</div>
        <div>
          <div class="tile-title">Group 9: Memory</div>
          <div class="tile-subtitle">Processes & effects</div>
        </div>
      </div>
    </div>

    <!-- SENSATION & PERCEPTION -->
    <div class="tile sens" data-group="10">
      <div class="tile-header">
        <div class="tile-icon">üëÅ</div>
        <div>
          <div class="tile-title">Group 10: Sensation</div>
          <div class="tile-subtitle">Detection & thresholds</div>
        </div>
      </div>
    </div>

    <div class="tile sens" data-group="11">
      <div class="tile-header">
        <div class="tile-icon">üî∑</div>
        <div>
          <div class="tile-title">Group 11: Gestalt & Depth</div>
          <div class="tile-subtitle">Gestalt rules</div>
        </div>
      </div>
    </div>

    <!-- RESEARCH & STATS -->
    <div class="tile stats" data-group="12">
      <div class="tile-header">
        <div class="tile-icon">üî¨</div>
        <div>
          <div class="tile-title">Group 12: Research Methods</div>
          <div class="tile-subtitle">Variables & design</div>
        </div>
      </div>
    </div>

    <div class="tile stats" data-group="13">
      <div class="tile-header">
        <div class="tile-icon">üìä</div>
        <div>
          <div class="tile-title">Group 13: Statistics I & II</div>
          <div class="tile-subtitle">Descriptives + correlation</div>
        </div>
      </div>
    </div>

    <div class="tile stats" data-group="14">
      <div class="tile-header">
        <div class="tile-icon">üìà</div>
        <div>
          <div class="tile-title">Group 14: Data Analysis</div>
          <div class="tile-subtitle">Quantitative vs qualitative</div>
        </div>
      </div>
    </div>

    <div class="tile stats" data-group="15">
      <div class="tile-header">
        <div class="tile-icon">‚öñÔ∏è</div>
        <div>
          <div class="tile-title">Group 15: Ethics</div>
          <div class="tile-subtitle">APA rules</div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- GAME CARD -->
<div id="game-card" class="hidden">

  <div id="game-header-row">
    <div>
      <h2 id="gameHeader"></h2>
      <p style="margin:0; font-size:0.85rem; color:var(--text-muted);">
        Select a term, then tap its matching definition.
      </p>
    </div>

    <button class="button secondary" id="backBtn">Back to Menu</button>
  </div>

  <div id="status-bar">
    <span id="score">Score: 0 / 0</span>
    <span id="streak">Streak: 0</span>
    <span id="timerDisplay">Time: 0s</span>
  </div>

  <div class="container">
    <div class="column" id="termsCol">
      <h3>Terms</h3>
    </div>

    <div class="column" id="defsCol">
      <h3>Definitions</h3>
    </div>
  </div>

  <div id="teachBlock" class="hidden" style="margin-top:10px; font-size:0.85rem;"></div>

  <p id="message"></p>
  <div id="celebration" class="hidden"></div>

  <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
    <button class="button secondary" id="resetBtn">Restart Set</button>
  </div>

</div> <!-- END GAME CARD -->
<script>
// ---------- STATE ----------
let currentGroup = null;
let termSelection = null;
let defSelection = null;
let score = 0;
let streak = 0;
let startTime = null;
let timerInterval = null;
let timerOn = false;
let teachMode = false;

// ---------- UTILITIES ----------
function $(id) { return document.getElementById(id); }

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

// ---------- GAME LOGIC ----------
function openSet(num) {
  currentGroup = groups[num];
  if (!currentGroup) return;

  $("menu-card").classList.add("hidden");
  $("game-card").classList.remove("hidden");

  $("gameHeader").textContent = `Group ${num}`;
  $("message").textContent = "";
  $("celebration").classList.add("hidden");

  streak = 0;
  score = 0;
  updateScoreAndStreak();

  if (timerInterval) clearInterval(timerInterval);
  if (timerOn) {
    startTime = Date.now();
    timerInterval = setInterval(updateTimer, 250);
  } else {
    $("timerDisplay").textContent = "Time: 0s";
  }

  buildColumns();

  if (teachMode) showTeachBlock();
  else $("teachBlock").classList.add("hidden");
}

function buildColumns() {
  const termsCol = $("termsCol");
  const defsCol = $("defsCol");

  termsCol.innerHTML = "<h3>Terms</h3>";
  defsCol.innerHTML = "<h3>Definitions</h3>";

  const idx = currentGroup.map((_, i) => i);
  const shuffledTerms = shuffle([...idx]);
  const shuffledDefs = shuffle([...idx]);

  shuffledTerms.forEach(i => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.index = i;
    div.textContent = currentGroup[i][0];
    div.onclick = () => selectTerm(div);
    termsCol.appendChild(div);
  });

  shuffledDefs.forEach(i => {
    const div = document.createElement("div");
    div.className = "item";
    div.dataset.index = i;
    div.textContent = currentGroup[i][1];
    div.onclick = () => selectDef(div);
    defsCol.appendChild(div);
  });

  score = 0;
  updateScoreAndStreak();
}

function showTeachBlock() {
  const el = $("teachBlock");
  el.classList.remove("hidden");

  let html = "<strong>Study view:</strong><ul style='margin-top:4px; padding-left:18px;'>";
  currentGroup.forEach(([t, d]) => {
    html += `<li><strong>${t}</strong>: ${d}</li>`;
  });
  html += "</ul>";

  el.innerHTML = html;
}

function selectTerm(el) {
  if (el.classList.contains("matched")) return;

  termSelection = el;
  document.querySelectorAll("#termsCol .item").forEach(e => e.classList.remove("selected"));
  el.classList.add("selected");

  tryMatch();
}

function selectDef(el) {
  if (el.classList.contains("matched")) return;

  defSelection = el;
  document.querySelectorAll("#defsCol .item").forEach(e => e.classList.remove("selected"));
  el.classList.add("selected");

  tryMatch();
}

function tryMatch() {
  if (!termSelection || !defSelection) return;

  const correct = termSelection.dataset.index === defSelection.dataset.index;

  if (correct) {
    termSelection.classList.add("matched");
    defSelection.classList.add("matched");
    termSelection.classList.remove("selected");
    defSelection.classList.remove("selected");

    termSelection = null;
    defSelection = null;

    score++;
    streak++;
    $("message").textContent = "‚úÖ Correct!";
    updateScoreAndStreak();

    if (score === currentGroup.length) {
      endRoundSuccess();
    }

  } else {
    streak = 0;
    $("message").textContent = "‚ùå Try again.";

    const t = termSelection;
    const d = defSelection;

    termSelection = null;
    defSelection = null;

    setTimeout(() => {
      t.classList.remove("selected");
      d.classList.remove("selected");
    }, 300);
  }
}

function updateScoreAndStreak() {
  $("score").textContent = `Score: ${score} / ${currentGroup.length}`;
  $("streak").textContent = `Streak: ${streak}`;
}

function updateTimer() {
  if (!startTime) return;
  const elapsed = Math.floor((Date.now() - startTime) / 1000);
  $("timerDisplay").textContent = `Time: ${elapsed}s`;
}

function endRoundSuccess() {
  $("message").textContent = "üéâ All matches found!";
  $("celebration").textContent = "‚ú® Great job! ‚ú®";
  $("celebration").classList.remove("hidden");

  if (timerInterval) clearInterval(timerInterval);
}

// ---------- TEACHER TOOLS ----------
let teacherPanelVisible = false;

function toggleTeacherPanel() {
  teacherPanelVisible = !teacherPanelVisible;
  $("teacherPanel").style.display = teacherPanelVisible ? "block" : "none";
}

function revealAllAnswers() {
  if (!currentGroup) return;

  document.querySelectorAll("#termsCol .item").forEach(e => e.classList.add("matched"));
  document.querySelectorAll("#defsCol .item").forEach(e => e.classList.add("matched"));

  score = currentGroup.length;
  updateScoreAndStreak();

  $("message").textContent = "üëÄ All answers revealed.";
}

function resetProgress() {
  streak = 0;
  $("message").textContent = "Progress reset.";
}

// ---------- EVENT HOOKUP ----------
document.addEventListener("DOMContentLoaded", () => {

  // Load menu tiles
  document.querySelectorAll(".tile").forEach(tile => {
    tile.onclick = () => openSet(parseInt(tile.dataset.group));
  });

  // Back to menu
  $("backBtn").onclick = () => {
    $("game-card").classList.add("hidden");
    $("menu-card").classList.remove("hidden");
    $("celebration").classList.add("hidden");
    $("message").textContent = "";

    if (timerInterval) clearInterval(timerInterval);
  };

  // Restart set
  $("resetBtn").onclick = () => {
    if (!currentGroup) return;

    $("message").textContent = "";
    $("celebration").classList.add("hidden");

    buildColumns();
    if (teachMode) showTeachBlock();

    if (timerOn) {
      if (timerInterval) clearInterval(timerInterval);
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 250);
    }
  };

  // Toggles
  $("darkToggle").onchange = e => {
    document.body.classList.toggle("dark", e.target.checked);
  };

  $("timerToggle").onchange = e => {
    timerOn = e.target.checked;
    if (!timerOn && timerInterval) {
      clearInterval(timerInterval);
      $("timerDisplay").textContent = "Time: 0s";
    }
  };

  $("teachToggle").onchange = e => {
    teachMode = e.target.checked;
    if (teachMode && currentGroup) showTeachBlock();
    else $("teachBlock").classList.add("hidden");
  };

  // Teacher panel shortcuts
  $("revealBtn").onclick = revealAllAnswers;
  $("resetProgressBtn").onclick = resetProgress;

  document.addEventListener("keydown", e => {
    if (e.shiftKey && e.key.toLowerCase() === "t") {
      toggleTeacherPanel();
    }
  });
});
</script>
